<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RandomAce - Balanced Layout</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            min-height: 100vh; margin: 0; padding: 20px; 
            background-color: #f0f2f5; color: #333; 
        }
        .main-container { max-width: 900px; width: 100%; flex: 1; }
        
        /* Text inputs */
        .input-group { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .input-section { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        textarea { width: 100%; height: 60px; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-family: inherit; resize: none; box-sizing: border-box; }

        /* Pool controls */
        .pools-container { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .pool-box { background: #fff; padding: 10px; border-radius: 12px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .pool-label { font-size: 11px; font-weight: bold; margin-bottom: 5px; display: block; color: #777; text-transform: uppercase; }
        
        .btn { padding: 10px 15px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: bold; transition: 0.3s; margin: 2px; }
        .btn:hover:not(:disabled) { background: #0056b3; transform: translateY(-1px); }
        .btn-spin { background: #ffc107 !important; color: #212529 !important; font-size: 18px !important; padding: 15px 40px !important; display: block; margin: 10px auto !important; width: 250px; }

        /* RESULT AREA (The Card) */
        #display-area { 
            width: 100%; min-height: 400px; background: white; border-radius: 20px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.1); padding: 30px; box-sizing: border-box;
            border: 1px solid #e0e0e0;
        }

        /* IMAGE GRID LIMITATION */
        .images-result-row { 
            display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; 
            margin-top: 20px; width: 100%; 
        }
        
        .img-slot { 
            width: 220px; /* Fixed width */
            text-align: center; 
        }

        .img-slot img { 
            width: 220px;    /* Fixed size */
            height: 220px;   /* Fixed size to keep them uniform */
            object-fit: cover; /* Crops the image to fill the square without stretching */
            border-radius: 15px; 
            border: 3px solid #f0f2f5;
            background-color: #fafafa;
            display: block;
        }

        .slot-label { font-size: 12px; font-weight: bold; color: #bbb; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 1px; }

        .result-text { font-size: 2rem; font-weight: 800; margin: 5px 0; text-align: center; line-height: 1; }
        #res-1 { color: #007bff; } 
        #res-2 { color: #6f42c1; }

        /* Previews */
        .preview-list { display: flex; gap: 3px; margin-top: 5px; flex-wrap: wrap; justify-content: center; overflow: hidden; height: 35px; }
        .preview-item { width: 30px; height: 30px; object-fit: cover; border-radius: 4px; opacity: 0.4; }

        .shaking { animation: shake 0.1s infinite; }
        @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(1px, -1px); } }
        
        .action-btns { text-align: center; margin-top: 15px; display: none; }
        #toast { position: fixed; bottom: 20px; background: #333; color: white; padding: 12px 25px; border-radius: 30px; display: none; z-index: 100; }
        footer { margin-top: 40px; padding: 20px; font-size: 14px; color: #aaa; text-align: center; border-top: 1px solid #eee; width: 100%; }
    </style>
</head>
<body>

    <div class="main-container">
        <h1 style="text-align: center; color: #007bff; letter-spacing: -1px;">ðŸ¥° RandomAce</h1>

        <div class="input-group">
            <div class="input-section">
                <label>Text Pool A</label>
                <textarea id="text-1" placeholder="Names or Traits..."></textarea>
            </div>
            <div class="input-section">
                <label>Text Pool B</label>
                <textarea id="text-2" placeholder="Roles or Actions..."></textarea>
            </div>
        </div>

        <div class="pools-container">
            <div class="pool-box">
                <span class="pool-label">Pool 1</span>
                <input type="file" id="file-1" accept="image/*" multiple style="display: none;">
                <button class="btn" onclick="document.getElementById('file-1').click()">+ Images</button>
                <div id="preview-1" class="preview-list"></div>
            </div>
            <div class="pool-box">
                <span class="pool-label">Pool 2</span>
                <input type="file" id="file-2" accept="image/*" multiple style="display: none;">
                <button class="btn" onclick="document.getElementById('file-2').click()">+ Images</button>
                <div id="preview-2" class="preview-list"></div>
            </div>
            <div class="pool-box">
                <span class="pool-label">Pool 3</span>
                <input type="file" id="file-3" accept="image/*" multiple style="display: none;">
                <button class="btn" onclick="document.getElementById('file-3').click()">+ Images</button>
                <div id="preview-3" class="preview-list"></div>
            </div>
        </div>

        <button class="btn btn-spin" id="random-btn">ðŸš€ SPIN ALL</button>

        <div id="action-btns" class="action-btns">
            <button class="btn" style="background:#6c757d" id="copy-btn">ðŸ“‹ Copy Result</button>
            <button class="btn" style="background:#17a2b8" id="save-btn">ðŸ’¾ Save Image</button>
        </div>

        <div id="display-area">
            <div id="res-1" class="result-text">Ready to Ace</div>
            <div id="res-2" class="result-text" style="font-size: 1.2rem; font-weight: 400; color: #888;">Add data and spin</div>
            
            <div class="images-result-row">
                <div class="img-slot" id="slot-1"></div>
                <div class="img-slot" id="slot-2"></div>
                <div class="img-slot" id="slot-3"></div>
            </div>
        </div>
    </div>

    <div id="toast">Copied to clipboard!</div>

    <footer>by <strong>eviltorn</strong> &copy; 2026</footer>

    <script>
        const randomBtn = document.getElementById('random-btn');
        const displayArea = document.getElementById('display-area');
        let pools = [[], [], []];

        [1, 2, 3].forEach(num => {
            document.getElementById(`file-${num}`).addEventListener('change', function(e) {
                for (let file of e.target.files) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        pools[num-1].push(event.target.result);
                        const img = document.createElement('img');
                        img.src = event.target.result;
                        img.className = 'preview-item';
                        document.getElementById(`preview-${num}`).appendChild(img);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });

        randomBtn.addEventListener('click', function() {
            const list1 = document.getElementById('text-1').value.split('\n').map(s => s.trim()).filter(s => s !== "");
            const list2 = document.getElementById('text-2').value.split('\n').map(s => s.trim()).filter(s => s !== "");
            
            if (pools[0].length === 0 && pools[1].length === 0 && pools[2].length === 0 && list1.length === 0 && list2.length === 0) return;

            randomBtn.disabled = true;
            document.getElementById('action-btns').style.display = 'none';
            displayArea.classList.add('shaking');

            let counter = 0;
            const interval = setInterval(() => {
                if (list1.length > 0) document.getElementById('res-1').innerText = list1[Math.floor(Math.random() * list1.length)];
                if (list2.length > 0) document.getElementById('res-2').innerText = list2[Math.floor(Math.random() * list2.length)];
                
                [1, 2, 3].forEach(num => {
                    const pool = pools[num-1];
                    if (pool.length > 0) {
                        document.getElementById(`slot-${num}`).innerHTML = `
                            <div class="slot-label">Pool ${num}</div>
                            <img src="${pool[Math.floor(Math.random() * pool.length)]}">
                        `;
                    }
                });

                counter++;
                if (counter >= 25) {
                    clearInterval(interval);
                    displayArea.classList.remove('shaking');
                    randomBtn.disabled = false;
                    document.getElementById('action-btns').style.display = 'block';
                }
            }, 80);
        });

        async function capture() { return await html2canvas(displayArea, { backgroundColor: "#ffffff", scale: 2 }); }
        
        document.getElementById('copy-btn').addEventListener('click', async () => {
            const canvas = await capture();
            canvas.toBlob(blob => {
                const item = new ClipboardItem({ [blob.type]: blob });
                navigator.clipboard.write([item]);
                showToast("Copied to clipboard!");
            });
        });

        document.getElementById('save-btn').addEventListener('click', async () => {
            const canvas = await capture();
            const link = document.createElement('a');
            link.download = 'RandomAce-Result.png';
            link.href = canvas.toDataURL();
            link.click();
        });

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 2000);
        }
    </script>
</body>
</html>
